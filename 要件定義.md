## 概要
本サービスはドキュメントに対するレビュー文化を助長するためのものであり、これを主目的としたレビュー機能を提供する記事投稿サイトである。

## 全体像
以下に示す。
![](https://cdn.discordapp.com/attachments/1287975597485723701/1287978029011963934/image.png?ex=67054ec3&is=6703fd43&hm=bb736e06320f0e78ff84121f93952eb9fe86c04a8ad960adde5c15448bca4fb6&)

## 記事
記事は、投稿者によって投稿される。
記事idによって識別され、タイトル、本文、投稿日、最終更新日、公開フラグ、閲覧数を持つ。
タイトルは1文字以上255文字以下、本文は1文字以上300,000万字以下に限定される。

## ユーザー
当サービスを利用する人物を **ユーザー** と呼称する。
ユーザーは名前、ユーザー概要、アイコンを設定することができ、ユーザーIDによって識別される。
ユーザーid・ユーザー名は1文字以上15文字以下、ユーザー概要は400字以下に限定される。

### 認証
ユーザーは、新規登録時に以下のSNSアカウントを連携することができる。
- Google
- GitHub
新規登録を行った際、SNSでの表示名、メールアドレスまたは電話番号、プロバイダ、ユーザー固有の uid がシステムに記録される。
新規登録後、ユーザーは自身のユーザーID、ユーザー名、アイコン、説明を設定する。IDはサービス内でユニークである必要がある。

### 認可
ユーザーは、新規登録時に使用したSNSアカウントを使用してログイン処理を行うことができる。
アカウント認証については supabase に一任するため、ここでは取り扱わない。


ユーザーは、サービスの利用目的によって以下の2種類（またはその両方）に分類される。
## 投稿者
 ユーザーのうち、記事を投稿するユーザーのことを **投稿者** と呼ぶ。
### 記事の新規作成
投稿者は、記事の下書きを作成することができる。
下書きは未公開の記事として作成され、公開状態は公開フラグを用いて管理される。
下書きの状態では他のユーザーは閲覧することはできない。
### 記事の投稿
投稿者は、下書きを任意のタイミングで公開することができる。公開した場合、記事の公開フラグがオンになる。
公開した場合、記事固有のURLによってアクセスすることができるようになる。

### 記事の編集
投稿者は、自身が投稿した記事の内容を編集することができる。
### 記事の削除
投稿者は、自身が投稿した記事を削除することができる。

## 閲覧者
ユーザーのうち、記事を閲覧するユーザーのことを **閲覧者** と呼ぶ。
### 記事の閲覧
閲覧者は、投稿者の記事を閲覧することができる。
記事を閲覧した際、対応する記事の閲覧数をカウントする。
### いいね
閲覧者は、任意の記事に対していいねを送信・取消することができる。
いいねは１つの記事につき１つまで送信できる。

## ディスカッション
記事に寄せられるレビューを行うためのチャンネルを **ディスカッション** と呼ぶ。
記事一つにつき一つのディスカッションチャンネルがあり、その中に複数のレビューが含まれる。

## レビュー
記事に寄せられたコメントを **レビュー** と呼ぶ。レビューは id、本文、投稿日、最終更新日をもつ。レビューが他のレビューにリプライ形式で送信された場合、親レビューの id をもつ。
レビュー本文は1文字以上10,000文字以下に限定される。

## レビュワー
ユーザーのうち、記事に対してレビューを送信するユーザーを **レビュワー** と呼ぶ。
レビュワーはプロフィールにこれまで受け取ったバッジ数が表示される。

### レビューを投稿する
レビュワーは、記事に対してレビューを投稿できる。これは、他のレビューにリプライする形式でも投稿できる。

### レビューを評価する
レビュワーは、他のレビューに対して賛成票もしくは反対票を投じることができる。票は１レビュー/１ユーザーにつき１つであり、賛成か反対どちらかのみ投じることができる。
レビュー票はレビューid、ユーザーid、票スコア（賛成なら+1、反対なら-1）を持ち、レビューidとユーザーidで識別される。

## バッジ
バッジは、レビュワーによって決められる参考になったレビューを指すものである。
基本的には以下のような視点で評価されることを期待している。
- 元記事に対して有効な付加情報を提供している。
- 元記事の誤りに対して有効な指摘を提供している。
- 元記事で論じられている内容について、有効な議論を提供している。

バッジは、表示するテキストと**フレーム**（バッジのデザイン）を選択して作成することができる。バッジテキストの選択肢を以下に示す。
- "Thank you"
- "LGTM"
- "Interesting"
- "Valuable"
- "Good Review"

バッジのフレームはフレームidで識別され、値段を持つ。
フレーム画像はsupabase上の画像ストレージに保存され、リンクによって表示される。

### バッジを送信する
ユーザーは、参考になったと感じたレビューに対して有料でバッジを送信できる。
バッジは複数種類の外見が用意されており、バッジを送信する意図によって使い分けることができる。

## 支払いについて
支払処理は、stripe 上で処理される。
たとえばユーザーがバッジを購入する際、システムによって指定された stripe 上の決済ページに移動し、決済を行う。
決済が完了した場合、領収書などの決済情報は stripe 上で保存される。
